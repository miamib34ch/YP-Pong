/// –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É UI-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (—ç–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞)
import UIKit
import AVFoundation

/// –≠—Ç–æ –∫–ª–∞—Å—Å –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞ –Ω–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
///
/// –í –∫–ª–∞—Å—Å–µ –µ—Å—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–≥—Ä—ã:
/// - `ballView` - –º—è—á
/// - `userPaddleView` - –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∏–≥—Ä–æ–∫–∞
/// - `enemyPaddleView` - –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ —Å–æ–ø–µ—Ä–Ω–∫–∞
///
/// –¢–∞–∫–∂–µ –≤ –∫–ª–∞—Å—Å–µ –¥–∞–Ω–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è —Ñ–∏–∑–∏–∫–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤
/// –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `enableDynamics()`
///
/// –ê –µ—â–µ –≤ —ç—Ç–æ–º –∫–ª–∞—Å—Å–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–≤–∏–∂–µ–Ω–∏—è –ø–∞–ª—å—Ü–∞ –ø–æ —ç–∫—Ä–∞–Ω—É,
/// —Å –ø–æ–º–æ—â—å—é –æ–±—Ä–∞–±–æ—Ç–∫–∏ —ç—Ç–æ–≥–æ –∂–µ—Å—Ç–∞ –∏–≥—Ä–æ–∫ –º–æ–∂–µ—Ç –¥–≤–∏–≥–∞—Ç—å —Å–≤–æ—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –∏ –æ—Ç—Ç–∞–ª–∫–∏–≤–∞—Ç—å –º—è—á
///
class PongViewController: UIViewController {

    // MARK: - Overriden Properties

    /// –≠—Ç–∞ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–æ–ø—É—Å—Ç–∏–º—ã–µ –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏–∏ —ç–∫—Ä–∞–Ω–∞
    override var supportedInterfaceOrientations: UIInterfaceOrientationMask { .portrait }

    // MARK: - Subviews

    /// –≠—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º—è—á–∞
    @IBOutlet var ballView: UIView!

    /// –≠—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –∏–≥—Ä–æ–∫–∞
    @IBOutlet var userPaddleView: UIView!

    /// –≠—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã —Å–æ–ø–µ—Ä–Ω–∏–∫–∞
    @IBOutlet var enemyPaddleView: UIView!

    /// –≠—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–∞–∑–¥–µ–ª—è—é—â–µ–π –ª–∏–Ω–∏–∏
    @IBOutlet var lineView: UIView!

    /// –≠—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ª—ç–π–±–ª–∞ —Å–æ —Å—á–µ—Ç–æ–º –∏–≥—Ä–æ–∫–∞
    @IBOutlet var userScoreLabel: UILabel!
    @IBOutlet weak var enemyScoreLabel: UILabel!
    // MARK: - Instance Properties

    /// –≠—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∂–µ—Å—Ç–∞ –¥–≤–∏–∂–µ–Ω–∏—è –ø–∞–ª—å—Ü–µ–º –ø–æ —ç–∫—Ä–∞–Ω—É
    var panGestureRecognizer: UIPanGestureRecognizer?

    /// –≠—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –≤ –∫–æ—Ç–æ—Ä–æ–π –º—ã –±—É–¥–µ–º –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–µ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è,
    /// –ø–µ—Ä–µ–¥ —Ç–µ–º –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞—á–∞–ª –¥–≤–∏–≥–∞—Ç—å –ø–∞–ª—å—Ü–µ–º –ø–æ —ç–∫—Ä–∞–Ω—É
    var lastUserPaddleOriginLocation: CGFloat = 0

    /// –≠—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Ç–∞–π–º–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å –ø–æ–ª–æ–∂–µ–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã —Å–æ–ø–µ—Ä–Ω–∏–∫–∞
    var enemyPaddleUpdateTimer: Timer?

    /// –≠—Ç–æ —Ñ–ª–∞–≥ `Bool`, –∏–º–µ–µ—Ç –¥–≤–∞ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è:
    /// - `true` - –º–æ–∂–Ω–æ —Ç—Ä–∞–∫—Ç–æ–≤–∞—Ç—å –∫–∞–∫ "–¥–∞"
    /// - `false` - –º–æ–∂–Ω–æ —Ç—Ä–∞–∫—Ç–æ–≤–∞—Ç—å –∫–∞–∫ "–Ω–µ—Ç"
    ///
    /// –û–Ω –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –∑–∞–ø—É—Å—Ç–∏—Ç—å –º—è—á –ø–æ —Å–ª–µ–¥—É—é—â–µ–º—É –Ω–∞–∂–∞—Ç–∏—é –Ω–∞ —ç–∫—Ä–∞–Ω
    ///
    var shouldLaunchBallOnNextTap: Bool = false

    /// –≠—Ç–æ —Ñ–ª–∞–≥ `Bool`, –∫–æ—Ç–æ—Ä—ã–π —É–∫–∞–∑—ã–≤–∞–µ—Ç "–±—ã–ª –ª–∏ –∑–∞–ø—É—â–µ–Ω –º—è—á"
    var hasLaunchedBall: Bool = false

    var enemyPaddleUpdatesCounter: UInt8 = 0

    // NOTE: –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∏–∂–µ –≤–ø–ª–æ—Ç—å –¥–æ 74-–æ–π —Å—Ç—Ä–æ–∫–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Ñ–∏–∑–∏–∫–∏
    // –ú—ã –Ω–µ –±—É–¥–µ–º –≤–¥–∞–≤–∞—Ç—å—Å—è –≤ –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ —Ç–æ–≥–æ, —á—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ –∏ –∫–∞–∫ —É—Å—Ç—Ä–æ–µ–Ω–æ
    var dynamicAnimator: UIDynamicAnimator?
    var ballPushBehavior: UIPushBehavior?
    var ballDynamicBehavior: UIDynamicItemBehavior?
    var userPaddleDynamicBehavior: UIDynamicItemBehavior?
    var enemyPaddleDynamicBehavior: UIDynamicItemBehavior?
    var collisionBehavior: UICollisionBehavior?

    // NOTE: –í—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–π –≤–ø–ª–æ—Ç—å –¥–æ 82-–æ–π —Å—Ç—Ä–æ–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è —Ä–µ–∞–≥–∏—Ä–æ–≤–∞–Ω–∏—è
    // –Ω–∞ —Å—Ç–ª–æ–∫–Ω–æ–≤–µ–Ω–∏—è –º—è—á–∞ - –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏–µ –∑–≤—É–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è –∏ –≤–∏–±—Ä–æ-–æ—Ç–∫–ª–∏–∫
    var audioPlayers: [AVAudioPlayer] = []
    var audioPlayersLock = NSRecursiveLock()
    var softImpactFeedbackGenerator = UIImpactFeedbackGenerator(style: .soft)
    var lightImpactFeedbackGenerator = UIImpactFeedbackGenerator(style: .light)
    var rigidImpactFeedbackGenerator = UIImpactFeedbackGenerator(style: .rigid)

    /// –≠—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –ø–ª–µ–µ—Ä–∞ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –ø–æ–≤—Ç–æ—Ä—è—é—â–µ–≥–æ—Å—è –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏—è —Ñ–æ–Ω–æ–≤–æ–π –º—É–∑—ã–∫–∏ –≤ –∏–≥—Ä–µ
    var backgroundSoundAudioPlayer: AVAudioPlayer? = {
        guard
            let backgroundSoundURL = Bundle.main.url(forResource: "background", withExtension: "wav"),
            let audioPlayer = try? AVAudioPlayer(contentsOf: backgroundSoundURL)
        else { return nil }

        audioPlayer.volume = 0.5
        audioPlayer.numberOfLoops = -1

        return audioPlayer
    }()

    /// –≠—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Ö—Ä–∞–Ω–∏—Ç —Å—á–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    var userScore: Int = 0 {
        didSet {
            /// –ü—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π - –æ–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –≤ –ª—ç–π–±–ª–µ
            updateUserScoreLabel()
            /// –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–±–µ–¥—É
            checkWinOrLose()
        }
    }
    
    /// –≠—Ç–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Ö—Ä–∞–Ω–∏—Ç —Å—á–µ—Ç –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞
    var enemyScore: Int = 0 {
        didSet {
            /// –ü—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π - –æ–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –≤ –ª—ç–π–±–ª–µ
            updateEnemyScoreLabel()
            /// –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–±–µ–¥—É
            checkWinOrLose()
        }
    }


    // MARK: - Instance Methods

    /// –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è 1 —Ä–∞–∑ –∫–æ–≥–¥–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —ç–∫—Ä–∞–Ω–∞ –∑–∞–≥—Ä—É–∑–∏–ª–æ—Å—å
    /// –∏ –≤–æ—Ç-–≤–æ—Ç –ø–æ–∫–∞–∂–µ—Ç—Å—è –≤ –æ–∫–Ω–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    override func viewDidLoad() {
        super.viewDidLoad()

        /*
        NOTE: üë®‚Äçüíª –ó–∞–º–µ—Ç–∫–∞ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —ç–∫—Ä–∞–Ω–∞ –∏–≥—Ä—ã üë®‚Äçüíª

        –°–µ–π—á–∞—Å —ç—Ç–æ—Ç –∫–æ–¥ –≤—ã–¥–µ–ª–µ–Ω —Å–µ—Ä—ã–º, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å–ª—ç—à —Å–æ –∑–≤–µ–∑–¥–æ—á–∫–æ–π
        –Ω–∞–¥ —ç—Ç–∏–º —Ç–µ–∫—Å—Ç–æ–º –∏ –ø–æ–¥ —ç—Ç–∏–º —Ç–µ–∫—Å—Ç–æ–º `/* */` –¥–µ–ª–∞—é—Ç –µ–≥–æ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–º –∫–æ–º–º–µ–Ω–∞—Ç—Ä–∏–µ–º.
        –¢–∞–∫–∂–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –±—ã–≤–∞—é—Ç –æ–¥–Ω–æ—Å—Ç—Ä–æ—á–Ω—ã–µ, –æ–Ω–∏ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å –¥–≤—É—Ö —Å–ª—ç—à–µ–π: `//`
        –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ - —ç—Ç–æ –∑–∞–º–µ—Ç–∫–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –æ —Ä–∞–±–æ—Ç–µ –∫—É—Å–æ—á–∫–∞ –∫–æ–¥–∞.
        –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –∞ –ø—Ä–æ—Å—Ç–æ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è.

        –ö–æ–¥ –Ω–∞ 127-–æ–π —Å—Ç—Ä–æ–∫–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –¥–ª—è –∏–≥—Ä—ã.
        –°–µ–π—á–∞—Å –æ–Ω –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω - –≤ –Ω–∞—á–∞–ª–µ —Å—Ç—Ä–æ–∫–∏ —Å—Ç–æ—è—Ç –¥–≤–∞ —Å–ª—ç—à–∞ `//`,
        –∏ —Ñ—É–Ω–∫—Ü–∏—è `configurePongGame()` –Ω–µ –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è.
        –£–¥–∞–ª–∏ –¥–≤–∞ —Å–ª—ç—à–∞ –≤ –Ω–∞—á–∞–ª–µ 127-–æ–π —Å—Ç—Ä–æ–∫–∏ –∏ –∑–∞–ø—É—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç, —á—Ç–æ–±—ã –∏–≥—Ä–∞ –∑–∞—Ä–∞–±–æ—Ç–∞–ª–∞!
        */

        configurePongGame()
    }

    /// –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ —ç–∫—Ä–∞–Ω PongViewController –ø–æ–≤—è–∏–ª—Å—è –Ω–∞ —ç–∫—Ä–∞–Ω–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    override func viewDidAppear(_ animated: Bool) {
        super.viewDidAppear(animated)

        // NOTE: –í–∫–ª—é—á–∞–µ–º –¥–∏–Ω–∞–º–∏–∫—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
        self.enableDynamics()
    }

    /// –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è, –∫–æ–≥–¥–∞ —ç–∫—Ä–∞–Ω –ø–µ—Ä–≤—ã–π —Ä–∞–∑ –æ—Ç—Ä–∏—Å–æ–≤–∞–ª –≤–µ—Å—å —Å–≤–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
    override func viewDidLayoutSubviews() {
        super.viewDidLayoutSubviews()

        // NOTE: –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —à–∞—Ä—É —Ä–∞–¥–∏—É—Å —Å–∫—Ä—É–≥–ª–µ–Ω–∏—è —Ä–∞–≤–Ω—ã–π –ø–æ–ª–æ–≤–∏–Ω–µ –≤—ã—Å–æ—Ç—ã
        ballView.layer.cornerRadius = ballView.bounds.size.height / 2
    }

    /// –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞—á–∞–ª–æ –≤—Å–µ—Ö –∫–∞—Å–∞–Ω–∏–π —ç–∫—Ä–∞–Ω–∞
    override func touchesBegan(
        _ touches: Set<UITouch>,
        with event: UIEvent?
    ) {
        super.touchesBegan(touches, with: event)

        // NOTE: –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –º—è—á –∏ –º—è—á –µ—â–µ –Ω–µ –±—ã–ª –∑–∞–ø—É—â–µ–Ω - –∑–∞–ø—É—Å–∫–∞–µ–º –º—è—á
        if shouldLaunchBallOnNextTap, !hasLaunchedBall {
            hasLaunchedBall = true

            launchBall()
        }
    }

    // MARK: - Private Methods

    /// –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Å—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é (–Ω–∞—Å—Ç—Ä–æ–π–∫—É) —ç–∫—Ä–∞–Ω–∞
    ///
    /// - –≤–∫–ª—é—á–∞–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∫—É –∂–µ—Å—Ç–∞ –¥–≤–∏–∂–µ–Ω–∏—è –ø–∞–ª—å—Ü–µ–º –ø–æ —ç–∫—Ä–∞–Ω—É
    /// - –≤–∫–ª—é—á–∞–µ—Ç –¥–∏–Ω–∞–º–∏–∫—É –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    /// - —É–∫–∞–∑—ã–≤–∞–µ—Ç —á—Ç–æ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –Ω–∞–∂–∞—Ç–∏–∏ –º—è—á –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è
    ///
    private func configurePongGame() {
        // NOTE: –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ª—ç–π–±–ª —Å–æ —Å—á–µ—Ç–æ–º –∏–≥—Ä–æ–∫–∞
        updateUserScoreLabel()
        
        // NOTE: –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ª—ç–π–±–ª —Å–æ —Å—á–µ—Ç–æ–º –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞
        updateEnemyScoreLabel()

        // NOTE: –í–∫–ª—é—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É –∂–µ—Å—Ç–∞ –¥–≤–∏–∂–µ–Ω–∏—è –ø–∞–ª—å—Ü–µ–º –ø–æ —ç–∫—Ä–∞–Ω—É
        self.enabledPanGestureHandling()

        // NOTE: –í–∫–ª—é—á–∞–µ–º –ª–æ–≥–∏–∫—É –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã –ø—Ä–æ—Ç–∏–≤–Ω–∏–∫–∞ "—Å–ª–µ–¥–æ–≤–∞—Ç—å –∑–∞ –º–µ—á–æ–º"
        self.enableEnemyPaddleFollowBehavior()

        // NOTE: –£–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ —ç–∫—Ä–∞–Ω –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –º—è—á
        self.shouldLaunchBallOnNextTap = true

        // NOTE: –ù–∞—á–∏–Ω–∞–µ–º –ø—Ä–æ–∏–≥—Ä—ã–≤–∞—Ç—å —Ñ–æ–Ω–æ–≤—É—é –º—É–∑—ã–∫—É
        self.backgroundSoundAudioPlayer?.prepareToPlay()
        self.backgroundSoundAudioPlayer?.play()
    }

    private func updateUserScoreLabel() {
        userScoreLabel.text = "\(userScore)"
    }
    private func updateEnemyScoreLabel() {
        enemyScoreLabel.text = "\(enemyScore)"
    }
    
    func checkWinOrLose(){
        if userScore == 5{
            /// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–æ–±–µ–¥–µ
            self.showToast(message: "–í—ã –ø–æ–±–µ–¥–∏–ª–∏!", font: .systemFont(ofSize: 20.0))
            /// –û–±–Ω—É–ª—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —Å–Ω–∞—á–∞–ª–∞ —Ç—É, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–±–µ–¥–∏–ª–∞;  –ø–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —á–∏—Å–ª–∞, –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è —ç—Ç–∞ –∂–µ —Ñ—É–Ω–∫—Ü–∏—è –∏ –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –æ–±–Ω—É–ª–µ–Ω–∏—è, —É—Å–ª–æ–≤–∏–µ –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è, –ø–æ—Å–∫–æ–ª—å–∫—É –æ–±–Ω—É–ª–∏–ª–∏ –Ω–µ –≤—ã–∏–≥—Ä—É—à–Ω—É—é –∏ –ø–æ–ª—É—á–∏—Ç—Å—è –≤–µ—á–Ω—ã–π —Ü–∏–∫–ª
            userScore = 0
            enemyScore = 0
        }
        else if enemyScore == 1 {
            /// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –ø–æ–±–µ–¥–µ
            self.showToast(message: "–í—ã –ø—Ä–æ–∏–≥—Ä–∞–ª–∏!", font: .systemFont(ofSize: 20.0))
            /// –û–±–Ω—É–ª—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —Å–Ω–∞—á–∞–ª–∞ —Ç—É, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–±–µ–¥–∏–ª–∞;  –ø–æ—Ç–æ–º—É —á—Ç–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —á–∏—Å–ª–∞, –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è —ç—Ç–∞ –∂–µ —Ñ—É–Ω–∫—Ü–∏—è –∏ –ø—Ä–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –æ–±–Ω—É–ª–µ–Ω–∏—è, —É—Å–ª–æ–≤–∏–µ –≤—Å–µ–≥–¥–∞ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è, –ø–æ—Å–∫–æ–ª—å–∫—É –æ–±–Ω—É–ª–∏–ª–∏ –Ω–µ –≤—ã–∏–≥—Ä—É—à–Ω—É—é –∏ –ø–æ–ª—É—á–∏—Ç—Å—è –≤–µ—á–Ω—ã–π —Ü–∏–∫–ª
            enemyScore = 0
            userScore = 0
        }
    }
    
}
